## 27. GitHub Packages çŸ¥è¯†ç‚¹ç¬”è®°

### æ ¸å¿ƒæ¦‚å¿µ

* **GitHub Packages**ï¼šæ˜¯ GitHub æä¾›çš„åŒ…ç®¡ç†æœåŠ¡ï¼Œå…è®¸ç”¨æˆ·å°†è½¯ä»¶åŒ…ï¼ˆå¦‚ npm, Maven, Docker ç­‰ï¼‰æ¨é€åˆ° GitHub è‡ªå·±çš„ä»“åº“ä¸­ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚
* **æ”¶è´¹æ”¿ç­–**ï¼š
    * **å…¬å¼€ä»“åº“**ï¼šå…è´¹æä¾›åŠŸèƒ½ã€‚
    * **ç§äººä»“åº“**ï¼šå…è´¹æä¾› 500MB å­˜å‚¨ç©ºé—´ï¼Œæ¯æœˆ 1GB ä¼ è¾“å¸¦å®½ã€‚
![](imges/image1.png)
### ä¸€ã€å‘å¸ƒ npm åŒ…åˆ° GitHub Packagesï¼ˆå‘å¸ƒä¾§ï¼‰

| æ­¥éª¤ | æ“ä½œå‘½ä»¤/æ–‡ä»¶ | å…³é”®é…ç½®/è¯´æ˜ |
| :--- | :--- | :--- |
| **1. ç¯å¢ƒå‡†å¤‡** | `node -v` / `npm -v` | ç¡®ä¿ Node.js å’Œ npm å·²å®‰è£…ã€‚ |
| **2. åˆå§‹åŒ–é¡¹ç›®** | `npm init` | åˆå§‹åŒ– npm åŒ…ï¼Œæ³¨æ„åœ¨ `@` åæ¥ä¸Š **`@<ç”¨æˆ·å>/<ä»“åº“å>`**ã€‚ |
| | | **ç¤ºä¾‹ï¼š** `@taxshamp/package-example`ã€‚ |
| **3. å®‰è£…ä¾èµ–** | `npm install` | ç”Ÿæˆ `package-lock.json` æ–‡ä»¶ã€‚ |
| **4. è‡ªåŠ¨å‘å¸ƒé…ç½®** | `.github/workflows/release-package.yml` | åˆ›å»º GitHub Actions Workflow æ–‡ä»¶ï¼Œç”¨äºè‡ªåŠ¨å‘å¸ƒã€‚ |
| | **è§¦å‘å™¨** | é…ç½®ä¸º `on: release: types: [created]`ï¼ˆæ¯æ¬¡åˆ›å»º Release æ—¶è§¦å‘ï¼‰ã€‚ |
| | **Registry URL (é‡ç‚¹)** | åœ¨ `actions/setup-node` æ­¥éª¤ä¸­ï¼Œè®¾ç½® `registry-url:` ä¸º **`https://npm.pkg.github.com`**ã€‚ |
| | **å‘å¸ƒå‘½ä»¤** | `npm publish`ã€‚ |
| | **Token** | ä½¿ç”¨å†…ç½®çš„ **`${{ secrets.GITHUB_TOKEN }}`**ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºå’Œé…ç½®ã€‚ |
| **5. é…ç½® `package.json`** | `package.json` | åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€è¡Œé…ç½®ï¼Œå‘Šè¯‰ npm å‘å¸ƒçš„ç›®æ ‡åœ°å€ã€‚ |
| | **é…ç½®é¡¹** | æ·»åŠ  `"publishConfig": { "registry": "https://npm.pkg.github.com/" }` |
| **6. è§¦å‘å‘å¸ƒ** | GitHub ç•Œé¢ | **åˆ›å»º Release**ï¼ˆCreate a new releaseï¼‰ï¼ŒAction ä¼šè‡ªåŠ¨è¿è¡Œå¹¶æ¨é€åŒ…ã€‚ |
| **ç»“æœ** | **é¡¹ç›®ä¸»é¡µå³ä¾§** | å‡ºç° **Packages** é€‰é¡¹å¡ï¼Œç‚¹å‡»å³å¯çœ‹åˆ°å‘å¸ƒçš„åŒ…ã€‚ |

---

### äºŒã€ä½¿ç”¨ GitHub Packages ä¸­çš„åŒ…ï¼ˆæ¶ˆè´¹ä¾§ï¼‰

| æ­¥éª¤ | æ“ä½œå‘½ä»¤/æ–‡ä»¶ | å…³é”®é…ç½®/è¯´æ˜ |
| :--- | :--- | :--- |
| **1. å£°æ˜ä¾èµ–** | `package.json` | åœ¨ `dependencies` ä¸­æ·»åŠ éœ€è¦ä½¿ç”¨çš„åŒ…åŠå…¶ç‰ˆæœ¬ã€‚ |
| | **ç¤ºä¾‹ï¼š** `"@taxshamp/package-example": "^1.0.0"` |
| **2. é…ç½® npm æ³¨å†Œè¡¨ (Registry)** | `.npmrc` | **å¿…é¡»**åˆ›å»ºæ­¤æ–‡ä»¶ï¼Œå‘Šè¯‰ npm ä¸ä»…è¦å»å®˜æ–¹ä»“åº“ï¼Œä¹Ÿè¦å» GitHub Packages æŸ¥æ‰¾ã€‚ |
| | **ç¬¬ä¸€è¡Œé…ç½®** | **å£°æ˜æ³¨å†Œè¡¨åœ°å€**ï¼š`@<ç”¨æˆ·å>:registry=https://npm.pkg.github.com/` |
| | | **ç¤ºä¾‹ï¼š** `@taxshamp:registry=https://npm.pkg.github.com/` |
| **3. è·å–è®¿é—®æƒé™** | **GitHub Token** | éœ€è¦åˆ›å»ºä¸€ä¸ª **Personal Access Token (PAT)** æ¥è·å–ç§æœ‰åŒ…çš„è®¿é—®æƒé™ã€‚ |
| | **Token æƒé™** | å¿…é¡»å‹¾é€‰ **`write:packages`** å’Œ **`read:packages`** ç­‰ä¸ package ç›¸å…³çš„æƒé™ã€‚ |
| | **Token é…ç½®** | åœ¨ `.npmrc` ä¸­æ·»åŠ ï¼š`//npm.pkg.github.com/:_authToken=<ä½ çš„PAT>` |
| **4. å®‰è£…åŒ…** | `npm install` | åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œï¼Œå³å¯ä» GitHub Packages ä¸‹è½½å®‰è£…ã€‚ |
| **æœ€ç»ˆæ•ˆæœ** | **`node_modules`** | å³å¯çœ‹åˆ°ä¸‹è½½å¥½çš„åŒ…ã€‚ |

---

### ğŸ”‘ æ€»ç»“ä½¿ç”¨æ­¥éª¤

1.  åœ¨ `package.json` çš„ `dependencies` ä¸­æ·»åŠ åŒ…å¼•ç”¨ã€‚
2.  åˆ›å»º `.npmrc` æ–‡ä»¶ï¼Œå°† **GitHub Packages å£°æ˜ä¸º npm ä»“åº“ä¹‹ä¸€**ã€‚
3.  åœ¨ `.npmrc` ä¸­é…ç½® **GitHub Personal Access Token (PAT)** ç”¨äºè®¤è¯ã€‚